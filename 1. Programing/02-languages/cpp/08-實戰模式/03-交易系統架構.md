# 交易系統架構

完整的 Trading Engine 與 Risk Management 設計。

---

## 1. Trading Engine 核心

```cpp
class TradingEngine {
    OrderBookManager order_books_;
    Strategy strategy_;
    RiskManager risk_manager_;
    OrderGateway gateway_;
    
public:
    void on_market_data(const MarketTick& tick) {
        // 1. 更新 Order Book
        order_books_.update(tick);
        
        // 2. 策略決策
        auto signals = strategy_.generate_signals(tick);
        
        // 3. 風險檢查
        for (auto& signal : signals) {
            if (risk_manager_.check(signal)) {
                // 4. 發送訂單
                Order order = create_order(signal);
                gateway_.send(order);
            }
        }
    }
};
```

---

## 2. Risk Manager

```cpp
class RiskManager {
    struct Limits {
        double max_position_size = 10000;
        double max_order_value = 1000000;
        int max_orders_per_second = 100;
    };
    
    Limits limits_;
    double current_position_ = 0;
    
public:
    bool check(const Signal& signal) {
        // 檢查倉位限制
        if (std::abs(current_position_ + signal.quantity) > limits_.max_position_size) {
            return false;
        }
        
        // 檢查訂單金額
        if (signal.price * signal.quantity > limits_.max_order_value) {
            return false;
        }
        
        return true;
    }
};
```

---

## 參考資料

1. **Trading Systems**
   - [Algorithmic Trading](https://www.amazon.com/Algorithmic-Trading-Practitioners-Jeffrey-Bacidore/dp/0984870253)
