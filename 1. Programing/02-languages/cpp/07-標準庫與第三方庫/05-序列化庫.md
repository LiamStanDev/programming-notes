# 序列化庫

選擇合適的序列化方案對 HFT 系統的延遲影響巨大。

---

## 1. Protocol Buffers

### 1.1 定義訊息

```protobuf
// market_data.proto
syntax = "proto3";

message MarketTick {
    string symbol = 1;
    double price = 2;
    int32 volume = 3;
    int64 timestamp = 4;
}
```

### 1.2 使用

```cpp
#include "market_data.pb.h"

// 序列化
MarketTick tick;
tick.set_symbol("AAPL");
tick.set_price(150.25);
tick.set_volume(1000);

std::string serialized;
tick.SerializeToString(&serialized);

// 反序列化
MarketTick received;
received.ParseFromString(serialized);
```

---

## 2. FlatBuffers - 零拷貝

### 2.1 特點

- **零拷貝**: 直接存取序列化數據
- **超低延遲**: 無需解析
- **適合 HFT**: 納秒級延遲

### 2.2 定義

```flatbuffers
// market_data.fbs
table MarketTick {
    symbol: string;
    price: double;
    volume: int;
    timestamp: long;
}

root_type MarketTick;
```

---

## 3. SBE (Simple Binary Encoding)

### 3.1 金融專用

- **超低延遲**: 為金融市場數據設計
- **固定長度**: 可預測性能
- **廣泛使用**: CME, ICE 等交易所

---

## 參考資料

1. **Protocol Buffers**
   - [Protobuf Documentation](https://developers.google.com/protocol-buffers)

2. **FlatBuffers**
   - [FlatBuffers GitHub](https://github.com/google/flatbuffers)

3. **SBE**
   - [SBE GitHub](https://github.com/real-logic/simple-binary-encoding)
