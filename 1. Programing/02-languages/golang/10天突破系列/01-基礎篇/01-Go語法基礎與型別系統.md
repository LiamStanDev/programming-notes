# Day 1ï¼šGo èªæ³•åŸºç¤èˆ‡å‹åˆ¥ç³»çµ±

## ğŸ“š å­¸ç¿’ç›®æ¨™

- æŒæ¡ Go Modules ä¾è³´ç®¡ç†å¯¦æˆ°
- ç†è§£ Go çš„å‹åˆ¥ç³»çµ±èˆ‡ struct/interface è¨­è¨ˆ
- å€åˆ† Value Receiver èˆ‡ Pointer Receiver
- å¯¦è¸é¢å‘æ¥å£çš„è¨­è¨ˆæ€ç¶­

---

## 1. Go Modules å¯¦æˆ°

### 1.1 åˆå§‹åŒ–å°ˆæ¡ˆ

```bash
# å‰µå»ºæ–°å°ˆæ¡ˆ
mkdir myapp && cd myapp
go mod init github.com/username/myapp

# æŸ¥çœ‹ go.mod æ–‡ä»¶
cat go.mod
```

**go.mod çµæ§‹**ï¼š
```go
module github.com/username/myapp

go 1.21

require (
    github.com/gofiber/fiber/v2 v2.51.0
    github.com/jmoiron/sqlx v1.3.5
)
```

### 1.2 ä¾è³´ç®¡ç†æ ¸å¿ƒå‘½ä»¤

```bash
# æ·»åŠ ä¾è³´ï¼ˆè‡ªå‹•æ›´æ–° go.modï¼‰
go get github.com/gofiber/fiber/v2

# æ·»åŠ ç‰¹å®šç‰ˆæœ¬
go get github.com/jmoiron/sqlx@v1.3.5

# æ¸…ç†æœªä½¿ç”¨çš„ä¾è³´
go mod tidy

# ä¸‹è¼‰æ‰€æœ‰ä¾è³´åˆ°æœ¬åœ°ç·©å­˜
go mod download

# æŸ¥çœ‹ä¾è³´æ¨¹
go mod graph

# è¤‡è£½ä¾è³´åˆ° vendor ç›®éŒ„ï¼ˆå¯é¸ï¼‰
go mod vendor
```

### 1.3 Go Workspaceï¼ˆå¤šæ¨¡çµ„é–‹ç™¼ï¼‰

**ä½¿ç”¨å ´æ™¯**ï¼šæœ¬åœ°é–‹ç™¼æ™‚éœ€è¦åŒæ™‚ä¿®æ”¹å¤šå€‹æ¨¡çµ„

```bash
# å‰µå»º workspace
go work init ./service-a ./service-b

# æ·»åŠ æ¨¡çµ„åˆ° workspace
go work use ./service-c

# æŸ¥çœ‹ go.work æ–‡ä»¶
cat go.work
```

**go.work çµæ§‹**ï¼š
```go
go 1.21

use (
    ./service-a
    ./service-b
    ./service-c
)
```

**æ³¨æ„**ï¼š`go.work` ä¸æ‡‰æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶ç³»çµ±ã€‚

---

## 2. Go å‹åˆ¥ç³»çµ±åŸºç¤

### 2.1 åŸºæœ¬å‹åˆ¥

```go
// å¸ƒçˆ¾å‹
var isActive bool = true

// æ•´æ•¸å‹
var count int = 42
var age uint8 = 25  // 0-255

// æµ®é»æ•¸
var price float64 = 99.99

// å­—ç¬¦ä¸²
var name string = "Go"

// å‹åˆ¥æ¨æ–·
username := "alice"  // ç·¨è­¯å™¨æ¨æ–·ç‚º string
```

### 2.2 è¤‡åˆå‹åˆ¥

#### é™£åˆ— (Array)
```go
// å›ºå®šé•·åº¦
var arr [5]int
arr[0] = 1

// å­—é¢é‡åˆå§‹åŒ–
primes := [3]int{2, 3, 5}
```

#### åˆ‡ç‰‡ (Slice)
```go
// å‹•æ…‹é•·åº¦
var slice []int
slice = append(slice, 1, 2, 3)

// ä½¿ç”¨ make é åˆ†é…å®¹é‡
users := make([]string, 0, 10)  // len=0, cap=10

// åˆ‡ç‰‡æ“ä½œ
nums := []int{1, 2, 3, 4, 5}
subset := nums[1:4]  // [2, 3, 4]
```

#### æ˜ å°„ (Map)
```go
// è²æ˜ä¸¦åˆå§‹åŒ–
userAges := map[string]int{
    "alice": 30,
    "bob":   25,
}

// ä½¿ç”¨ make
cache := make(map[string]interface{})

// è®€å–èˆ‡å­˜åœ¨æ€§æª¢æŸ¥
age, exists := userAges["alice"]
if !exists {
    fmt.Println("User not found")
}

// åˆªé™¤
delete(userAges, "bob")
```

---

## 3. Struct èˆ‡æ–¹æ³•

### 3.1 å®šç¾© Struct

```go
// åŸºæœ¬çµæ§‹
type User struct {
    ID        int
    Username  string
    Email     string
    CreatedAt time.Time
}

// åµŒå¥—çµæ§‹
type Address struct {
    City    string
    Country string
}

type Employee struct {
    User            // åµŒå…¥å¼å­—æ®µï¼ˆåŒ¿åå­—æ®µï¼‰
    Address         // çµ„åˆæ¨¡å¼
    Department string
}
```

### 3.2 Struct Tagï¼ˆç”¨æ–¼åºåˆ—åŒ–ï¼‰

```go
type Product struct {
    ID    int     `json:"id" db:"product_id"`
    Name  string  `json:"name" db:"product_name"`
    Price float64 `json:"price" db:"price"`
}

// JSON åºåˆ—åŒ–
import "encoding/json"

p := Product{ID: 1, Name: "Laptop", Price: 999.99}
jsonData, _ := json.Marshal(p)
// è¼¸å‡º: {"id":1,"name":"Laptop","price":999.99}
```

### 3.3 Value Receiver vs Pointer Receiver

#### Value Receiver
```go
type Counter struct {
    value int
}

// æ¥æ”¶è€…æ˜¯å€¼é¡å‹ï¼Œæ“ä½œçš„æ˜¯å‰¯æœ¬
func (c Counter) Increment() {
    c.value++  // ä¸æœƒä¿®æ”¹åŸå§‹ Counter
}

func main() {
    c := Counter{value: 0}
    c.Increment()
    fmt.Println(c.value)  // è¼¸å‡º: 0
}
```

#### Pointer Receiverï¼ˆæ¨è–¦ï¼‰
```go
// æ¥æ”¶è€…æ˜¯æŒ‡é‡é¡å‹ï¼Œç›´æ¥ä¿®æ”¹åŸå§‹å°è±¡
func (c *Counter) Increment() {
    c.value++  // ä¿®æ”¹æˆåŠŸ
}

func main() {
    c := Counter{value: 0}
    c.Increment()
    fmt.Println(c.value)  // è¼¸å‡º: 1
}
```

**é¸æ“‡åŸå‰‡**ï¼š
1. **éœ€è¦ä¿®æ”¹æ¥æ”¶è€…**ï¼šä½¿ç”¨ Pointer Receiver
2. **æ¥æ”¶è€…æ˜¯å¤§å‹çµæ§‹**ï¼šä½¿ç”¨ Pointer Receiverï¼ˆé¿å…è¤‡è£½ï¼‰
3. **ä¿æŒä¸€è‡´æ€§**ï¼šå¦‚æœæŸå€‹æ–¹æ³•ä½¿ç”¨ Pointer Receiverï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ‡‰ä½¿ç”¨

---

## 4. Interface èˆ‡å¤šæ…‹

### 4.1 æ¥å£å®šç¾©

```go
// æ¥å£è²æ˜
type Storage interface {
    Save(key string, value interface{}) error
    Load(key string) (interface{}, error)
    Delete(key string) error
}
```

### 4.2 Duck Typingï¼ˆéš±å¼å¯¦ç¾ï¼‰

Go ä¸éœ€è¦é¡¯å¼è²æ˜å¯¦ç¾æ¥å£ï¼Œåªè¦å¯¦ç¾äº†æ¥å£çš„æ‰€æœ‰æ–¹æ³•å³å¯ã€‚

```go
// å…§å­˜å­˜å„²å¯¦ç¾
type MemoryStorage struct {
    data map[string]interface{}
}

func (m *MemoryStorage) Save(key string, value interface{}) error {
    m.data[key] = value
    return nil
}

func (m *MemoryStorage) Load(key string) (interface{}, error) {
    val, exists := m.data[key]
    if !exists {
        return nil, fmt.Errorf("key not found: %s", key)
    }
    return val, nil
}

func (m *MemoryStorage) Delete(key string) error {
    delete(m.data, key)
    return nil
}

// è‡ªå‹•æ»¿è¶³ Storage æ¥å£ï¼ˆç„¡éœ€é¡¯å¼è²æ˜ï¼‰
```

### 4.3 æ¥å£çµ„åˆ

```go
type Reader interface {
    Read(p []byte) (n int, err error)
}

type Writer interface {
    Write(p []byte) (n int, err error)
}

// çµ„åˆæ¥å£
type ReadWriter interface {
    Reader
    Writer
}
```

### 4.4 ç©ºæ¥å£èˆ‡å‹åˆ¥æ–·è¨€

```go
// ç©ºæ¥å£å¯ä»¥æ¥å—ä»»ä½•å‹åˆ¥
var any interface{} = "hello"

// å‹åˆ¥æ–·è¨€
str, ok := any.(string)
if ok {
    fmt.Println("String value:", str)
}

// Type Switch
switch v := any.(type) {
case string:
    fmt.Println("String:", v)
case int:
    fmt.Println("Integer:", v)
default:
    fmt.Println("Unknown type")
}
```

---

## 5. é¢å‘æ¥å£è¨­è¨ˆå¯¦æˆ°

### 5.1 ä¾è³´æ³¨å…¥æ¨¡å¼

```go
// å®šç¾©æ¥å£
type Logger interface {
    Info(message string)
    Error(message string)
}

// å¯¦ç¾ 1ï¼šæ§åˆ¶å°æ—¥èªŒ
type ConsoleLogger struct{}

func (l *ConsoleLogger) Info(message string) {
    fmt.Println("[INFO]", message)
}

func (l *ConsoleLogger) Error(message string) {
    fmt.Println("[ERROR]", message)
}

// å¯¦ç¾ 2ï¼šæ–‡ä»¶æ—¥èªŒ
type FileLogger struct {
    file *os.File
}

func (l *FileLogger) Info(message string) {
    l.file.WriteString("[INFO] " + message + "\n")
}

func (l *FileLogger) Error(message string) {
    l.file.WriteString("[ERROR] " + message + "\n")
}

// æœå‹™ä¾è³´æ¥å£ï¼Œè€Œéå…·é«”å¯¦ç¾
type UserService struct {
    logger Logger
}

func NewUserService(logger Logger) *UserService {
    return &UserService{logger: logger}
}

func (s *UserService) CreateUser(username string) {
    s.logger.Info("Creating user: " + username)
    // æ¥­å‹™é‚è¼¯...
}

// ä½¿ç”¨
func main() {
    // å¯ä»¥è¼•é¬†åˆ‡æ›å¯¦ç¾
    consoleLogger := &ConsoleLogger{}
    service := NewUserService(consoleLogger)
    service.CreateUser("alice")
}
```

### 5.2 ç­–ç•¥æ¨¡å¼

```go
// å®šç¾©ç­–ç•¥æ¥å£
type PaymentStrategy interface {
    Pay(amount float64) error
}

// ä¿¡ç”¨å¡æ”¯ä»˜
type CreditCardPayment struct {
    CardNumber string
}

func (c *CreditCardPayment) Pay(amount float64) error {
    fmt.Printf("Paid %.2f using credit card %s\n", amount, c.CardNumber)
    return nil
}

// PayPal æ”¯ä»˜
type PayPalPayment struct {
    Email string
}

func (p *PayPalPayment) Pay(amount float64) error {
    fmt.Printf("Paid %.2f using PayPal %s\n", amount, p.Email)
    return nil
}

// è¨‚å–®è™•ç†
type Order struct {
    Total           float64
    PaymentStrategy PaymentStrategy
}

func (o *Order) Checkout() error {
    return o.PaymentStrategy.Pay(o.Total)
}

// ä½¿ç”¨
func main() {
    order := &Order{
        Total:           99.99,
        PaymentStrategy: &CreditCardPayment{CardNumber: "1234"},
    }
    order.Checkout()
}
```

---

## 6. åŒ…ç®¡ç†èˆ‡çµ„ç¹”

### 6.1 åŒ…çš„çµ„ç¹”çµæ§‹

```
myapp/
â”œâ”€â”€ go.mod
â”œâ”€â”€ go.sum
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go          # æ‡‰ç”¨å…¥å£
â”œâ”€â”€ internal/                # ç§æœ‰ä»£ç¢¼ï¼ˆä¸èƒ½è¢«å¤–éƒ¨å¼•ç”¨ï¼‰
â”‚   â”œâ”€â”€ handler/
â”‚   â”‚   â””â”€â”€ user.go
â”‚   â”œâ”€â”€ service/
â”‚   â”‚   â””â”€â”€ user.go
â”‚   â””â”€â”€ repository/
â”‚       â””â”€â”€ user.go
â”œâ”€â”€ pkg/                     # å¯è¢«å¤–éƒ¨å¼•ç”¨çš„å…¬å…±åº«
â”‚   â”œâ”€â”€ logger/
â”‚   â”‚   â””â”€â”€ logger.go
â”‚   â””â”€â”€ validator/
â”‚       â””â”€â”€ validator.go
â””â”€â”€ config/
    â””â”€â”€ config.go
```

### 6.2 å°å…¥èˆ‡ä½¿ç”¨

```go
package main

import (
    // æ¨™æº–åº«
    "fmt"
    "net/http"
    
    // ç¬¬ä¸‰æ–¹åº«
    "github.com/gofiber/fiber/v2"
    
    // æœ¬åœ°åŒ…ï¼ˆä½¿ç”¨æ¨¡çµ„è·¯å¾‘ + ç›¸å°è·¯å¾‘ï¼‰
    "github.com/username/myapp/internal/handler"
    "github.com/username/myapp/pkg/logger"
)
```

### 6.3 åŒ…çš„å¯è¦‹æ€§

```go
package user

// å…¬é–‹ï¼ˆé¦–å­—æ¯å¤§å¯«ï¼‰
type User struct {
    ID   int
    Name string
}

// ç§æœ‰ï¼ˆé¦–å­—æ¯å°å¯«ï¼‰
type userCache struct {
    data map[int]*User
}

// å…¬é–‹æ–¹æ³•
func (u *User) GetID() int {
    return u.ID
}

// ç§æœ‰æ–¹æ³•
func (u *User) validate() error {
    // åªèƒ½åœ¨åŒ…å…§è¨ªå•
    return nil
}
```

---

## 7. å¯¦æˆ°ç·´ç¿’

### ç·´ç¿’ 1ï¼šå¯¦ç¾ä¸€å€‹é€šç”¨çš„ç·©å­˜æ¥å£

```go
package cache

type Cache interface {
    Set(key string, value interface{}, ttl int) error
    Get(key string) (interface{}, bool)
    Delete(key string) error
    Clear() error
}

// TODO: å¯¦ç¾ MemoryCache å’Œ RedisCache
```

### ç·´ç¿’ 2ï¼šå¯¦ç¾ä¸€å€‹å¤šæ…‹çš„é€šçŸ¥ç³»çµ±

```go
package notification

type Notifier interface {
    Send(to string, message string) error
}

// TODO: å¯¦ç¾ EmailNotifier, SMSNotifier, PushNotifier
```

### ç·´ç¿’ 3ï¼šä½¿ç”¨ Struct Tag è§£æé…ç½®

```go
package config

import (
    "encoding/json"
    "os"
)

type Config struct {
    Server struct {
        Port int    `json:"port"`
        Host string `json:"host"`
    } `json:"server"`
    Database struct {
        Host     string `json:"host"`
        Port     int    `json:"port"`
        Username string `json:"username"`
        Password string `json:"password"`
    } `json:"database"`
}

// TODO: å¯¦ç¾ LoadConfig å‡½æ•¸å¾ JSON æ–‡ä»¶åŠ è¼‰é…ç½®
```

---

## 8. æœ€ä½³å¯¦è¸ç¸½çµ

### âœ… Do's
1. **å„ªå…ˆä½¿ç”¨çµ„åˆè€Œéç¹¼æ‰¿**ï¼ˆé€šéåµŒå…¥å¯¦ç¾ï¼‰
2. **æ¥å£æ‡‰è©²å°è€Œå°ˆæ³¨**ï¼ˆéµå¾ªæ¥å£éš”é›¢åŸå‰‡ï¼‰
3. **è¿”å›æ¥å£ï¼Œæ¥å—çµæ§‹**ï¼ˆReturn concrete, accept interfaceï¼‰
4. **ä½¿ç”¨ Pointer Receiver ä¿®æ”¹ç‹€æ…‹æˆ–è™•ç†å¤§å‹çµæ§‹**
5. **ä½¿ç”¨ `go mod tidy` ä¿æŒä¾è³´æ¸…æ½”**

### âŒ Don'ts
1. **é¿å…éåº¦ä½¿ç”¨ç©ºæ¥å£ `interface{}`**
2. **ä¸è¦åœ¨å…¬å…± API ä¸­æš´éœ²å…§éƒ¨å¯¦ç¾ç´°ç¯€**
3. **ä¸è¦æ··ç”¨ Value å’Œ Pointer Receiver**
4. **ä¸è¦æäº¤ `go.work` æ–‡ä»¶åˆ°ç‰ˆæœ¬æ§åˆ¶**

---

## 9. å»¶ä¼¸é–±è®€

- [Effective Go](https://go.dev/doc/effective_go)
- [Go Modules Reference](https://go.dev/ref/mod)
- [Go Code Review Comments](https://github.com/golang/go/wiki/CodeReviewComments)

---

**ä¸‹ä¸€ç¯‡**: [Day 2 - éŒ¯èª¤è™•ç†èˆ‡è³‡æºç®¡ç†](../01-åŸºç¤ç¯‡/02-éŒ¯èª¤è™•ç†èˆ‡è³‡æºç®¡ç†.md)
