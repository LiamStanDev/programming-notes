# ç¶²è·¯é…ç½®
---
### è™›æ“¬æ©Ÿä½¿ç”¨çš„ç¶²è·¯é…ç½®
1. Bridge: åªè™›æ“¬æ©Ÿå…§éƒ¨**ç›´æ¥é€£æ¥å¤–éƒ¨ç‰©ç†ç¶²è·¯**çš„æ¨¡å¼
	![[Pasted image 20230808143017.png]]
	* å„ªé»ï¼šVMèˆ‡æ•´å€‹è·¯ç”±çš„è¨­å‚™æ˜¯å¹³ç´šï¼Œå¯ä»¥äº’ç›¸é€£é€šã€‚
	* ç¼ºé»ï¼šæœƒä½”ç”¨ipåœ°å€(ç”±å…¶æ˜¯æ¯å€‹PCéƒ½å»ºç«‹é›†ç¾¤æ™‚)ï¼Œä¸”è™›æ“¬æ©Ÿç¶²è·¯æ²’æœ‰éš±ç§
		ğŸ”¥ é›–ç„¶å¾ˆç°¡å–®ï¼Œä½†å› ç‚ºç¼ºé»(æ¶ˆè€—ipåœ°å€)å¾ˆæ˜é¡¯å¯¦å‹™ä¸Šä¸å¤ªä½¿ç”¨ã€‚
	* è™›æ“¬æ©Ÿä¹‹é–“èƒ½äº’é€š
	* å¤–éƒ¨èƒ½è¨ªå•è™›æ“¬æ©Ÿ
	* è™›æ“¬æ©Ÿèƒ½è¨ªå•å¤–ç¶²
	* è™›æ“¬æ©Ÿèƒ½è¨ªå•ä¸»æ©Ÿï¼šå› ç‚ºæ˜¯å¹³ç´šçš„
> DHCP : å‹•æ…‹åœ°å€åˆ†é…ï¼Œç•¶ç”¨æˆ¶é‡å¾ˆå¤§ä½†ä¸æœƒåŒæ™‚ä½¿ç”¨æ™‚ï¼Œå°±æœƒä½¿ç”¨DHCPä¾†åˆ†é…åœ°å€ã€‚
2. NAT (Network Address Translation)ï¼šæ¦‚å¿µ**å¾ˆåƒè™›æ“¬Router**ï¼Œåœ¨æœ¬æ©Ÿä¸Šè™›æ“¬å‡ºä¸€å€‹LANä¾›è™›æ“¬æ©Ÿä½¿ç”¨ï¼Œå…¶ä¸­ä¹Ÿä½¿ç”¨DHCPä¾†åˆ†é…ipã€‚
	* è™›æ“¬æ©Ÿèƒ½äº’ç›¸è¨ªå•ï¼šè™›æ“¬æ©Ÿæœ‰è‡ªå·±çš„å…§éƒ¨ipåœ°å€ã€‚
	* å¤–éƒ¨ä¸èƒ½è¨ªå•è™›æ“¬æ©Ÿï¼Œå¤–éƒ¨æ˜¯ä¸å­˜åœ¨è™›æ“¬æ©Ÿçš„ipåœ°å€ã€‚
	* è™›æ“¬æ©Ÿå¯ä»¥è¨ªå•å¤–ç¶²
	* è™›æ“¬æ©Ÿå¯ä»¥è¨ªå•ä¸»æ©Ÿé€²ï¼šVMWareæä¾›ä¸€å€‹ç¶²å¡(VMwareNet8)ã€‚
3. åƒ…ä¸»æ©Ÿæ¨¡å¼ï¼š
	* è™›æ“¬æ©Ÿèƒ½äº’ç›¸è¨ªå•
	* å¤–éƒ¨ä¸èƒ½è¨ªå•è™›æ“¬æ©Ÿ
	* è™›æ“¬æ©Ÿä¸èƒ½è¨ªå•å¤–ç¶²
	* è™›æ“¬æ©Ÿä¸èƒ½è¨ªå•ä¸»æ©Ÿ
 


# ç¶²è·¯å·¥å…·
---
### ä»‹ç´¹
æœ‰å…©å€‹é‡è¦çš„åŒ…net-toolsï¼ˆèˆŠï¼‰èˆ‡iproute2ï¼ˆæ–°ï¼‰ã€‚
net-toolsåŒ…å«ï¼š`ifconfig`, `netstat`, `route`
iproute2åŒ…å«ï¼š`ip addr`, `ip route`, `ip link`, `ss` ç­‰
ç¾åœ¨åŸºæœ¬ä¸Šé»˜èªä½¿ç”¨çš„éƒ½æ˜¯iproute2ã€‚
#### å®‰è£
##### apt
```shell
sudo apt install net-tools
sudo apt isntall iproute2
```

## ç¶²è·¯é…ç½®
### ip addr
```shell
ip addr [subcommand]
```
* subcommand:
	* add : è³¦äºˆæ–°çš„åœ°å€
	* show : é¡¯ç¤ºåœ°å€
	* del : åˆªé™¤åœ°å€
	* flush : åˆ·æ–°åœ°å€
### ip link
* ç”¨æ–¼ç®¡ç†ç¶²è·¯æ¥å£
```shell
ip link [subcommand]
```
* subcommand:
	* show: é¡¯ç¤ºç¶²è·¯æ¥å£
	* set: è¨­å®šç¶²è·¯æ¥å£
	* add: æ·»åŠ ç¶²è·¯æ¥å£
	* del: åˆªé™¤ç¶²è·¯æ¥å£
#### ip link set
```shell
ip link set ens up # é–‹å•Ÿensç¶²è·¯æ¥å£
ip link set ens down # é—œé–‰ensç¶²è·¯æ¥å£
```

### ip route
* ç®¡ç†è·¯ç”±è¡¨
```shell
ip route [subcommand]
```
* subcommand
	* show: é¡¯ç¤ºè·¯ç”±è¡¨
	* add: æ·»åŠ æ–°è·¯ç”±
	* del: åˆªé™¤è·¯ç”±
	* change: æ›´æ”¹è·¯ç”±

## ç¶²è·¯é€£é€šæ€§æ¢æ¸¬
### ping
ç”¨æ–¼æ¸¬è©¦èˆ‡å¦ä¸€å°ä¸»æ©Ÿçš„ç¶²è·¯é€£æ¥æƒ…æ³ã€‚
```shell
ping google.com
ping 192.168.0.1
```

### telnet
ç”¨æ–¼æ¸¬è©¦é ç¨‹æœå‹™(ç«¯å£)æ˜¯å¦èƒ½è¨ªå•
```shell
telnet google.com 443
```

### traceroute
æŸ¥çœ‹å¾åŸä¸»æ©Ÿæ‰€ç¶“éçš„æ‰€æœ‰çš„è·¯ç”±ç¯€é»ï¼Œæ’æŸ¥ç¶²è·¯é€£æ¥å•é¡Œ
```shell
traceroute google.com
```

### mtr: my trace route (æœ€å¥½ç”¨)
ç‚º ping traceroute çš„é›†å¤§æˆå·¥å…·ï¼Œå¥½è™•æ˜¯å¯ä»¥å¯¦æ™‚åˆ·æ–°
```shell
mtr google.com
```

## ç¶²è·¯é€£æ¥æƒ…æ³
### netstat (èˆŠ)
#### ä½¿ç”¨
```
netstat -tunlp
```
* -t : tcp
* -u : udp
* -l : listening
* -n : numeric, ä½¿ç”¨æ•¸å­—é¡¯ç¤ºipèˆ‡portï¼Œä¸ä½¿ç”¨åŸŸåè¡¨ç¤º
* -p : program, è¡¨ç¤ºé¡¯ç¤ºä½¿ç”¨ç«¯å£çš„ç¨‹åºåç¨±ã€‚
### ss
ç•¶ç«¯å£å¾ˆå¤šçš„æ™‚å€™netstatå°±æœƒå¾ˆæ…¢ï¼Œssæ˜¯ç¾åœ¨æ¨è–¦ä¸”å¼·å¤§çš„ç¶²è·¯ç«¯å£å·¥å…·ã€‚
å¥½çš„ä¸€é»æ˜¯ä½¿ç”¨æ–¹å¼èˆ‡netstatä¸€æ¨£ï¼Œä½†æ˜¯é‚„æœ‰æ›´å¤šé¸é …å¯ä»¥ä½¿ç”¨ï¼Œé€™é‚Šå°±ä¸è´…è¿°äº†ã€‚
